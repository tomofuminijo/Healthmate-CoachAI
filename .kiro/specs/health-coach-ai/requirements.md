# 要件定義書

## 概要

HealthCoachAIは、ユーザの健康目標達成を支援するAIエージェントです。Amazon Bedrock AgentCore Runtime上でPython + Strands Agentsを使用して実装され、既存のHealthManagerMCPサーバーと連携してユーザの健康情報を管理し、パーソナライズされた健康アドバイスとコーチングを提供します。

## 用語集

- **HealthCoachAI**: ユーザの健康管理を支援するAIエージェントシステム
- **HealthManagerMCP**: ユーザの健康情報を管理する既存のMCPサーバー
- **AgentCore Runtime**: Amazon Bedrock AgentCore Runtimeの実行環境
- **Strands Agents**: Pythonベースのエージェント実装フレームワーク
- **健康データ**: ユーザの健康に関する情報（体重、血圧、運動記録、食事記録等）
- **健康目標**: ユーザが設定した健康に関する目標
- **コーチングセッション**: AIエージェントがユーザに提供する健康指導セッション

## 要件

### 要件 1

**ユーザーストーリー:** ユーザとして、AIヘルスコーチと対話したい。そうすることで、パーソナライズされた健康指導とサポートを受けることができる。

#### 受け入れ基準

1. ユーザがHealthCoachAIとの会話を開始するとき、HealthCoachAIは適切な健康関連の指導で応答する
2. ユーザが健康関連の質問をするとき、HealthCoachAIはエビデンスに基づいたアドバイスと推奨事項を提供する
3. ユーザがコーチングサポートを要求するとき、HealthCoachAIはユーザを動機づけ指導するための支援的な対話を行う
4. 会話セッションが開始されるとき、HealthCoachAIは対話全体を通してコンテキストを維持する
5. 不適切な健康要求が行われるとき、HealthCoachAIは拒否し、適切な医療専門家に誘導する

### 要件 2

**ユーザーストーリー:** ユーザとして、AIコーチに私の健康データにアクセスしてもらいたい。そうすることで、現在の健康状態に基づいたパーソナライズされた推奨事項を受けることができる。

#### 受け入れ基準

1. HealthCoachAIが健康データを必要とするとき、HealthCoachAIはOAuth/Bearer認証を使用してHealthManagerMCPで認証を行う
2. ユーザの健康情報を取得するとき、HealthCoachAIはAgentCore Gateway経由でHealthManagerMCPにクエリを実行する
3. 健康データが正常に取得されるとき、HealthCoachAIはこの情報をパーソナライズされた推奨事項に組み込む
4. 健康データアクセスが失敗するとき、HealthCoachAIはエラーを適切に処理し、ユーザに適切に通知する
5. 機密の健康データにアクセスするとき、HealthCoachAIは安全な送信と処理を確保する

### 要件 3

**ユーザーストーリー:** ユーザとして、AIコーチを通じて健康情報を更新したい。そうすることで、健康記録を最新かつ正確に保つことができる。

#### 受け入れ基準

1. ユーザが新しい健康データを提供するとき、HealthCoachAIは情報の妥当性と形式を検証する
2. 健康データが検証されるとき、HealthCoachAIはHealthManagerMCP経由で情報を保存する
3. 健康データの更新が成功するとき、HealthCoachAIはユーザに更新を確認する
4. 健康データの更新が失敗するとき、HealthCoachAIは操作を再試行し、持続的な問題をユーザに通知する
5. 無効な健康データが提供されるとき、HealthCoachAIはユーザに明確化または修正を要求する

### 要件 4

**ユーザーストーリー:** ユーザとして、AIコーチと健康目標を設定し追跡したい。そうすることで、健康改善に向けて体系的に取り組むことができる。

#### 受け入れ基準

1. ユーザが健康目標を表明するとき、HealthCoachAIは具体的で測定可能な目標の策定を支援する
2. 健康目標が確立されるとき、HealthCoachAIは将来の参照のためにHealthManagerMCP経由で目標を保存する
3. 進捗を追跡するとき、HealthCoachAIは現在の健康データを確立された目標と比較する
4. 目標に向けて進歩が見られるとき、HealthCoachAIは肯定的な強化と励ましを提供する
5. 目標が達成されていないとき、HealthCoachAIは調整や代替アプローチを提案する

### 要件 5

**ユーザーストーリー:** ユーザとして、AIコーチにコンテキストに応じた健康インサイトを提供してもらいたい。そうすることで、健康データのパターンと傾向を理解することができる。

#### 受け入れ基準

1. 健康データを分析するとき、HealthCoachAIは意味のあるパターンと傾向を特定する
2. 健康傾向が検出されるとき、HealthCoachAIはその重要性をユーザに説明する
3. 懸念すべきパターンが現れるとき、HealthCoachAIはユーザに警告し、適切な行動を提案する
4. 肯定的な傾向が特定されるとき、HealthCoachAIは進歩を認め、継続を奨励する
5. 分析に十分なデータが存在しないとき、HealthCoachAIは追加情報を要求するか、データ収集戦略を提案する

### 要件 6

**ユーザーストーリー:** システム管理者として、AIコーチがAgentCore Runtime上で確実に動作してほしい。そうすることで、ユーザが一貫したサービス可用性に依存できる。

#### 受け入れ基準

1. AgentCore Runtimeにデプロイされるとき、HealthCoachAIは適切に初期化され、リクエストを処理する準備ができる
2. ユーザリクエストを処理するとき、HealthCoachAIは許容可能な時間制限内で応答する
3. システムエラーが発生するとき、HealthCoachAIは適切な診断情報をログに記録する
4. 外部依存関係が利用できないとき、HealthCoachAIは適切に劣化し、ユーザに通知する
5. システムリソースが制約されるとき、HealthCoachAIはメモリと処理を効率的に管理する

### 要件 7

**ユーザーストーリー:** 開発者として、AIコーチが既存のHealthMateインフラストラクチャとシームレスに統合してほしい。そうすることで、システムが結束して動作する。

#### 受け入れ基準

1. HealthManagerMCPに接続するとき、HealthCoachAIは既存のAgentCore Gateway設定を使用する
2. 外部サービスで認証するとき、HealthCoachAIは確立されたCognito認証システムを使用する
3. HealthMateUIから呼び出されるとき、HealthCoachAIはUI固有のAPIを必要とせずに適切に応答する
4. 設定変更が発生するとき、HealthCoachAIはコード修正を必要とせずに適応する
5. CloudFormationスタックリソースと統合するとき、HealthCoachAIは既存のインフラストラクチャコンポーネントを発見し使用する